<!DOCTYPE html><html lang="en"> <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>SLF4J | Play Framework Tutorial</title><meta name="generator" content="Jekyll v4.0.0" /><meta property="og:title" content="SLF4J" /><meta name="author" content="Dvir" /><meta property="og:locale" content="en_US" /><meta name="description" content="It’s time to add logging to our app. We will add logging using SLF4J, and bind the implementation to logback." /><meta property="og:description" content="It’s time to add logging to our app. We will add logging using SLF4J, and bind the implementation to logback." /><link rel="canonical" href="https://dvirf.github.io/play-tutorial/posts/slf4j/" /><meta property="og:url" content="https://dvirf.github.io/play-tutorial/posts/slf4j/" /><meta property="og:site_name" content="Play Framework Tutorial" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-04-07T01:00:36+03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="SLF4J" /><meta name="twitter:site" content="@playframework" /><meta name="twitter:creator" content="@Dvir" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"headline":"SLF4J","mainEntityOfPage":{"@type":"WebPage","@id":"https://dvirf.github.io/play-tutorial/posts/slf4j/"},"url":"https://dvirf.github.io/play-tutorial/posts/slf4j/","author":{"@type":"Person","name":"Dvir"},"description":"It’s time to add logging to our app. We will add logging using SLF4J, and bind the implementation to logback.","dateModified":"2020-04-07T01:00:36+03:00","datePublished":"2020-04-07T01:00:36+03:00","@type":"BlogPosting","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/play-tutorial/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/play-tutorial/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/play-tutorial/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/play-tutorial/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/play-tutorial/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/play-tutorial/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/play-tutorial/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/play-tutorial/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/play-tutorial/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/play-tutorial/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/play-tutorial/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/play-tutorial/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/play-tutorial/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/play-tutorial/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/play-tutorial/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/play-tutorial/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/play-tutorial/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/play-tutorial/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/play-tutorial/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/play-tutorial/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/play-tutorial/assets/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/play-tutorial/assets/css/main.css"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script> window.jQuery || document.write('<script src="/play-tutorial/assets/lib/jquery-3.4.1.min.js"><\/script>'); </script> <script src="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin="anonymous" async></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha256-5+02zu5UULQkO7w1GIr6vftCgMfFdZcAHeDtFnKZsBs=" crossorigin="anonymous" async></script> <script src="/play-tutorial/assets/js/dist/commons.js" async></script> <script src="/play-tutorial/assets/js/dist/timeago.min.js" async></script><link rel="preload" as="style" href="/play-tutorial/assets/css/post.css"><link rel="preload" as="style" href="/play-tutorial/assets/css/syntax.css"><link rel="stylesheet" href="/play-tutorial/assets/css/post.css"><link rel="stylesheet" href="/play-tutorial/assets/css/syntax.css"><link rel="preload" as="style" href="/play-tutorial/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="preload" as="script" href="/play-tutorial/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"><link rel="stylesheet" href="/play-tutorial/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" /> <script src="/play-tutorial/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script> <script src="/play-tutorial/assets/js/dist/toc.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/play-tutorial/" alt="avatar"> <img src="/play-tutorial/assets/img/sample/avatar.png"> </a></div><div class="profile-text mt-3"><div id="site-title"> <a href="/play-tutorial/">Play Framework Tutorial</a></div><div id="site-subtitle" class="font-italic">Build a Play Framework application from scratch</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/play-tutorial/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-3 mr-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/play-tutorial/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-3 mr-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="contact d-flex justify-content-around mt-4"> <a href="https://www.linkedin.com/in/dvir-faivel-82b737b3" target="_blank"> <i class="fab fa-linkedin-in"></i> </a> <a href="https://github.com/dvirf1/play-tutorial" target="_blank"> <i class="fab fa-github-alt"></i> </a> <!-- <a href="https://twitter.com/playframework" target="_blank"> <i class="fab fa-twitter"></i> </a> --> <a href="https://www.reddit.com/r/scala/" target="_blank"> <i class="fab fa-reddit-alien"></i> </a> <a href="https://www.playframework.com/" target="_blank"> <i class="fas fa-play"></i> </a></div></div><div id="main-wrapper"> <!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/play-tutorial/"> Posts </a> </span> <span>SLF4J</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <a href="javascript:;">Cancel</a></div></div><div id="main"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"> <!-- Define the liquid date formats. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>SLF4J</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago" data-toggle="tooltip" title="Tue, Apr 7, 2020, 1:00 AM +0300" hidden="true"> Apr 7, 2020 <i class="unloaded">2020-04-07T01:00:36+03:00</i> </span> on <a href='/play-tutorial/categories/logging/'>Logging</a></div></div><div class="post-content"><p>It’s time to add logging to our app.<br /> We will add logging using SLF4J, and bind the implementation to logback.</p><p><a href="http://www.slf4j.org/">SLF4J</a>, Simple Logging Facade for Java, serves as a simple facade or abstraction for various logging frameworks (e.g. java.util.logging, Logback, Log4j) allowing the end user to plug in the desired logging framework at deployment time.</p><p>This means that as a library author you can use SLF4J to log messages, and the app that consumes your library (and other libraries that support SLF4J) will choose the implementation. This is how you don’t impose the logging choice on your consumers.</p><p>Since we are writing an app, we will choose the implementation.<br /> We will use <a href="http://logback.qos.ch/">Logback</a>, which was created by the same developer that created log4j, but is <a href="http://logback.qos.ch/reasonsToSwitch.html">preferred</a>.</p><p>We will need to familiarize ourselves with several concepts:</p><ul><li><em>Appenders</em>: a logger can use one or more appenders, which are responsible for writing the logging events, e.g to the console, a file, slack, etc.</li><li><em>Logging Levels</em>: Loggers may be assigned levels (TRACE, DEBUG, INFO, WARN and ERROR).<br /> These levels are ordered: <code class="highlighter-rouge">TRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR</code>.<br /> When the user logs a message, the level of the logging request is determined by the printing method. e.g <code class="highlighter-rouge">logger.info("...")</code> is a logging statement of level INFO.<br /> The message will be logged only if the level of the logging request is higher than or equal to the level of the logger.</li><li><em>Logger hierarchy</em>: loggers have a tree like hierarchy, starting from the root logger, where dots are used to separate parents from children.<br /> For example, <code class="highlighter-rouge">com.foo</code> is the parent of <code class="highlighter-rouge">com.foo.bar</code>. Also, if there is no logger named “com”, then “com.foo” is the child of the root logger.<br /> Levels and appenders are inherited from the nearest ancestor logger.<br /> e.g when defining the logger <code class="highlighter-rouge">com.example.some_library</code>, we may set its level to INFO and its appenders to file and console appenders.<br /> The logger <code class="highlighter-rouge">com.example.some_library.aaa.bbb.ccc</code> will have the same level and appenders, as long as there is no logger in between these two loggers that changed the level/appenders (or set <a href="http://logback.qos.ch/manual/architecture.html#additivity">additivity</a> to false).</li></ul><h2 id="add-slf4j-to-our-build">Add <em>SLF4J</em> to our build</h2><p>Let’s add <a href="https://mvnrepository.com/artifact/ch.qos.logback/logback-classic">logback-classic</a> and <a href="https://mvnrepository.com/artifact/com.github.maricn/logback-slack-appender">logback-slack-appender</a> as dependencies in build.sbt:</p><div class="language-scala highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">libraryDependencies</span> <span class="o">++=</span> <span class="nc">Seq</span><span class="o">(</span>
  <span class="c1">// more dependencies here</span>
  <span class="s">"ch.qos.logback"</span> <span class="o">%</span> <span class="s">"logback-classic"</span> <span class="o">%</span> <span class="s">"1.2.3"</span><span class="o">,</span>
  <span class="s">"com.github.maricn"</span> <span class="o">%</span> <span class="s">"logback-slack-appender"</span> <span class="o">%</span> <span class="s">"1.4.0"</span><span class="o">,</span>
<span class="o">)</span>
</pre></table></code></div></div><p>Import Changes in IntelliJ so it will download the dependencies for you and help you with code completion (it will also reload the sbt shell behind the scenes).</p><p>Play already uses SLF4J for logging, backed by Logback as its default logging engine, so the logback dependency is not really needed, and is used for clarity here.</p><h2 id="configure-logback">Configure <em>Logback</em></h2><p>Add a file under <code class="highlighter-rouge">conf/logback.xml</code> (or change it if it already exists) with the following content:</p><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- https://www.playframework.com/documentation/latest/SettingsLogger --&gt;</span>
<span class="nt">&lt;configuration</span> <span class="na">debug=</span><span class="s">"false"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;variable</span> <span class="na">name=</span><span class="s">"APP_NAME"</span> <span class="na">value=</span><span class="s">"playground"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;contextName&gt;</span>${APP_NAME}<span class="nt">&lt;/contextName&gt;</span>

  <span class="c">&lt;!-- ********************************* appenders ********************************* --&gt;</span>
  <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"STDOUT"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.ConsoleAppender"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;encoder&gt;</span>
      <span class="nt">&lt;pattern&gt;</span>%date %contextName %highlight(%-5level) %-10([%thread]) %logger{36} - %message%n<span class="nt">&lt;/pattern&gt;</span>
    <span class="nt">&lt;/encoder&gt;</span>
  <span class="nt">&lt;/appender&gt;</span>

  <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"ASYNCSTDOUT"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.classic.AsyncAppender"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"STDOUT"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/appender&gt;</span>

  <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"FILE"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.rolling.RollingFileAppender"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;file&gt;</span>log/${APP_NAME}/${APP_NAME}.log<span class="nt">&lt;/file&gt;</span>
    <span class="nt">&lt;rollingPolicy</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy"</span><span class="nt">&gt;</span>
      <span class="c">&lt;!-- daily rollover. keep 14 days worth of history capped at 1GB total size --&gt;</span>
      <span class="nt">&lt;fileNamePattern&gt;</span>log/${APP_NAME}/${APP_NAME}.log.%d{yyyy-MM-dd}.%i<span class="nt">&lt;/fileNamePattern&gt;</span>
      <span class="nt">&lt;maxFileSize&gt;</span>100MB<span class="nt">&lt;/maxFileSize&gt;</span>
      <span class="nt">&lt;maxHistory&gt;</span>14<span class="nt">&lt;/maxHistory&gt;</span>
      <span class="nt">&lt;totalSizeCap&gt;</span>1GB<span class="nt">&lt;/totalSizeCap&gt;</span>
    <span class="nt">&lt;/rollingPolicy&gt;</span>
    <span class="nt">&lt;encoder&gt;</span>
      <span class="nt">&lt;pattern&gt;</span>%date %contextName %highlight(%-5level) %-10([%thread]) %logger{36} [%file:%line] %message%n<span class="nt">&lt;/pattern&gt;</span>
    <span class="nt">&lt;/encoder&gt;</span>
  <span class="nt">&lt;/appender&gt;</span>

  <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"ASYNCFILE"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.classic.AsyncAppender"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"FILE"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/appender&gt;</span>

  <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"SLACK"</span> <span class="na">class=</span><span class="s">"com.github.maricn.logback.SlackAppender"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- example https://hooks.slack.com/services/T1234ABCD/B1234ABCD/abcdefghijklmnopqrst1234 --&gt;</span>
    <span class="nt">&lt;webhookUri&gt;</span>${slack_webhook_url}<span class="nt">&lt;/webhookUri&gt;</span>
    <span class="c">&lt;!-- Channel that you want to post - default is #general. use #CHANNEL_NAME for channels and @USER_NAME for users --&gt;</span>
    <span class="nt">&lt;channel&gt;</span>#${APP_NAME}<span class="nt">&lt;/channel&gt;</span>
    <span class="c">&lt;!-- Formatting (you can use Slack formatting - URL links, code formatting, etc.) --&gt;</span>
    <span class="nt">&lt;layout</span> <span class="na">class=</span><span class="s">"ch.qos.logback.classic.PatternLayout"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;pattern&gt;</span>%message<span class="nt">&lt;/pattern&gt;</span>
    <span class="nt">&lt;/layout&gt;</span>
    <span class="c">&lt;!-- Username of the messages sender --&gt;</span>
    <span class="nt">&lt;username&gt;</span>${HOSTNAME}<span class="nt">&lt;/username&gt;</span>
    <span class="c">&lt;!-- Emoji to be used for messages --&gt;</span>
    <span class="nt">&lt;iconEmoji&gt;</span>:ghost:<span class="nt">&lt;/iconEmoji&gt;</span>
    <span class="nt">&lt;filter</span> <span class="na">class=</span><span class="s">"ch.qos.logback.classic.filter.ThresholdFilter"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;level&gt;</span>INFO<span class="nt">&lt;/level&gt;</span>
    <span class="nt">&lt;/filter&gt;</span>
  <span class="nt">&lt;/appender&gt;</span>

  <span class="c">&lt;!-- Currently recommended way of using Slack appender --&gt;</span>
  <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"ASYNC_SLACK"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.classic.AsyncAppender"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"SLACK"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/appender&gt;</span>

  <span class="c">&lt;!-- ********************************* loggers ********************************* --&gt;</span>
  <span class="c">&lt;!-- for our app --&gt;</span>
  <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"com.example.${APP_NAME}"</span> <span class="na">level=</span><span class="s">"DEBUG"</span><span class="nt">/&gt;</span>
  <span class="c">&lt;!-- for slack --&gt;</span>
  <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"com.example.${APP_NAME}.slack.async"</span> <span class="na">level=</span><span class="s">"INFO"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"ASYNC_SLACK"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/logger&gt;</span>
  <span class="c">&lt;!-- for slack, when the program is about to exit and we want the log immediately --&gt;</span>
  <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"com.example.${APP_NAME}.slack.synchronous"</span> <span class="na">level=</span><span class="s">"INFO"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"SLACK"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/logger&gt;</span>
  <span class="c">&lt;!-- for slack only (without log-file) --&gt;</span>
  <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"com.example.${APP_NAME}.slack.only"</span> <span class="na">level=</span><span class="s">"INFO"</span> <span class="na">additivity=</span><span class="s">"false"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"ASYNC_SLACK"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"STDOUT"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/logger&gt;</span>
  <span class="c">&lt;!-- for other jars in your organization --&gt;</span>
  <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"com.example"</span> <span class="na">level=</span><span class="s">"INFO"</span><span class="nt">/&gt;</span>
  <span class="c">&lt;!-- for all other components --&gt;</span>
  <span class="nt">&lt;root</span> <span class="na">level=</span><span class="s">"WARN"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"ASYNCFILE"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"ASYNCSTDOUT"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/root&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></table></code></div></div><p>This file defines the following loggers:</p><ul><li><code class="highlighter-rouge">&lt;root&gt;</code> logger: with level=WARN and file and console appenders. This will be applied to all third party components, such as <code class="highlighter-rouge">com.third.party</code></li><li><code class="highlighter-rouge">com.example</code> logger that inherits the appenders from the root logger (thus it also logs to a file and the console), and sets the level to INFO, since it may be interesting to get info messages from other components in your organiztion (<code class="highlighter-rouge">com.example</code>) like <code class="highlighter-rouge">com.example.library</code></li><li><code class="highlighter-rouge">com.example.playgroud</code> that also inherits the console and file appenders, and sets the level to DEBUG (you may want to change this in production).</li><li>Three slack loggers: synchronous, asynchronous and one that only logs to slack and to the console without logging to a file (using <code class="highlighter-rouge">additivity="false"</code>). These loggers write messages to the channel <code class="highlighter-rouge">#playground</code>, which you should create in advance. You can change the channel to <code class="highlighter-rouge">@your_user</code> to send a message to yourself instead. Also, make sure to provide a slack webhook url (via <code class="highlighter-rouge">slack_webhook_url</code>). See Slack API for further details.</li></ul><p>The file appender writes to <code class="highlighter-rouge">log/playground/playground.log</code>, and there’s a daily rotation of the log file, keeping the last 14 days of logs up to 1GB (so the log won’t take all the disk space in the server).<br /> It may sufficient to only log to STDOUT in case you have log shipment that ships the content of the standard outputs to a log system.</p><p>We don’t need the logs in the git repository, so we will add it to <code class="highlighter-rouge">.gitignore</code>:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>log/
# the rest of `.gitignore` content
</pre></table></code></div></div><h3 id="set-the-logger-in-the-applicationloader">Set the logger in the ApplicationLoader</h3><p>Since we are using a custom class loader, <a href="https://www.playframework.com/documentation/2.8.x/SettingsLogger#Using-a-custom-application-loader">we also need to configure logging with the <code class="highlighter-rouge">LoggerConfigurator</code></a>.<br /> In <code class="highlighter-rouge">AppLoader.scala</code>, add the <code class="highlighter-rouge">configureLogging</code> method and invoke it from the <code class="highlighter-rouge">load</code> method:</p><div class="language-scala highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">AppLoader</span> <span class="k">extends</span> <span class="nc">ApplicationLoader</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">load</span><span class="o">(</span><span class="n">context</span><span class="k">:</span> <span class="kt">Context</span><span class="o">)</span><span class="k">:</span> <span class="kt">Application</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nf">configureLogging</span><span class="o">(</span><span class="n">context</span><span class="o">)</span>
    <span class="c1">// rest of "load" body</span>
  <span class="o">}</span>

  <span class="k">private</span> <span class="k">def</span> <span class="nf">configureLogging</span><span class="o">(</span><span class="n">context</span><span class="k">:</span> <span class="kt">Context</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span>
    <span class="nc">LoggerConfigurator</span><span class="o">(</span><span class="nv">context</span><span class="o">.</span><span class="py">environment</span><span class="o">.</span><span class="py">classLoader</span><span class="o">).</span><span class="py">foreach</span> <span class="o">{</span>
      <span class="nv">_</span><span class="o">.</span><span class="py">configure</span><span class="o">(</span><span class="nv">context</span><span class="o">.</span><span class="py">environment</span><span class="o">,</span> <span class="nv">context</span><span class="o">.</span><span class="py">initialConfiguration</span><span class="o">,</span> <span class="nv">Map</span><span class="o">.</span><span class="py">empty</span><span class="o">)</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="use-the-logger">Use the logger</h2><p>Let’s write something to the log.<br /> For example, in <code class="highlighter-rouge">AppComponents.scala</code>:</p><div class="language-scala highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="nn">org.slf4j.LoggerFactory</span>

<span class="c1">// inside the body of AppComponents:</span>
<span class="k">private</span> <span class="k">val</span> <span class="nv">logger</span> <span class="k">=</span> <span class="nv">LoggerFactory</span><span class="o">.</span><span class="py">getLogger</span><span class="o">(</span><span class="n">getClass</span><span class="o">)</span>
<span class="nv">logger</span><span class="o">.</span><span class="py">debug</span><span class="o">(</span><span class="n">s</span><span class="s">"running in ${environment.mode} mode"</span><span class="o">)</span>
</pre></table></code></div></div><p><code class="highlighter-rouge">LoggerFactory.getLogger()</code> expects either a string with the logger name (e.g “com.example.playground.something”) or Class[T].<br /> It is convenient to simply call <code class="highlighter-rouge">getClass</code>, as it will return the runtime class of the current object, e.g in this case it will return <code class="highlighter-rouge">com.example.playground.configuration.components.DevComponents</code>.<br /> This logger, along with other loggers in “com.example.playground” package, inherits its level and appenders from the “com.example.playground” logger.</p><h3 id="send-slack-messages">Send slack messages</h3><p>If we want to log a message to slack we can use for example<br /> <code class="highlighter-rouge">val slackLoggerAsync = LoggerFactory.getLogger("com.example.playground.slack.async")</code><br /> to create a logger.<br /> Alternatively, you can create a simple class like:</p><div class="language-scala highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="k">package</span> <span class="nn">com.example.playground.configuration</span>

<span class="k">import</span> <span class="nn">org.slf4j.</span><span class="o">{</span><span class="nc">Logger</span><span class="o">,</span> <span class="nc">LoggerFactory</span><span class="o">}</span>

<span class="k">class</span> <span class="nc">SlackLogger</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">async</span><span class="k">:</span> <span class="kt">Logger</span> <span class="o">=</span> <span class="nv">LoggerFactory</span><span class="o">.</span><span class="py">getLogger</span><span class="o">(</span><span class="s">"com.example.playground.slack.async"</span><span class="o">)</span>
  <span class="k">val</span> <span class="nv">sync</span><span class="k">:</span> <span class="kt">Logger</span>  <span class="o">=</span> <span class="nv">LoggerFactory</span><span class="o">.</span><span class="py">getLogger</span><span class="o">(</span><span class="s">"com.example.playground.slack.synchronous"</span><span class="o">)</span>
  <span class="k">val</span> <span class="nv">only</span><span class="k">:</span> <span class="kt">Logger</span>  <span class="o">=</span> <span class="nv">LoggerFactory</span><span class="o">.</span><span class="py">getLogger</span><span class="o">(</span><span class="s">"com.example.playground.slack.only"</span><span class="o">)</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Then inject it to your services, e.g by adding <code class="highlighter-rouge">slackLogger: SlackLogger</code> to the constructor of the services and wire <code class="highlighter-rouge">SlackLogger</code>.</p><p>Once we have a slack logger, sending a message is as easy as using the logger, e.g</p><div class="language-scala highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">slackLogger</span><span class="o">.</span><span class="py">async</span><span class="o">.</span><span class="py">info</span><span class="o">(</span><span class="s">"hello world"</span><span class="o">)</span>
</pre></table></code></div></div><h2 id="slf4j-and-specific-bindings-logback-log4j">SLF4J and specific bindings (Logback, Log4j)</h2><p>Notice that our code always refers to classes in <code class="highlighter-rouge">org.slf4j</code> package, specifically <code class="highlighter-rouge">Logger</code> and <code class="highlighter-rouge">LoggerFactory</code>, and not to classes in <code class="highlighter-rouge">ch.qos.logback</code> package.<br /> The binding to logback is simply done by adding the logback dependency to the classpath, which we did in <code class="highlighter-rouge">build.sbt</code>.</p></div><div class="post-tail text-muted"><div class="mb-4"> <a href="/play-tutorial/tags/logging/" class="post-tag no-text-decoration" >logging</a> <a href="/play-tutorial/tags/slf4j/" class="post-tag no-text-decoration" >slf4j</a></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 topbar-down"><div class="access"><div id="access-tags" hidden="true"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <!-- The trending tags list v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT Licensed --> <a class="post-tag" href="/play-tutorial/tags/compile-time-dependency-injection/">compile time dependency injection</a> <a class="post-tag" href="/play-tutorial/tags/typesafe-config/">typesafe config</a> <a class="post-tag" href="/play-tutorial/tags/json/">json</a> <a class="post-tag" href="/play-tutorial/tags/db-api/">db api</a> <a class="post-tag" href="/play-tutorial/tags/tests/">tests</a> <a class="post-tag" href="/play-tutorial/tags/slf4j/">slf4j</a> <a class="post-tag" href="/play-tutorial/tags/skeleton/">skeleton</a> <a class="post-tag" href="/play-tutorial/tags/scalafmt/">scalafmt</a> <a class="post-tag" href="/play-tutorial/tags/sbt-native-packager/">sbt native packager</a> <a class="post-tag" href="/play-tutorial/tags/pureconfig/">pureconfig</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- The related posts of current post. Placed in the bottom of every single post. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/play-tutorial/posts/macwire/" class="btn btn-outline-primary"><p>Macwire</p></a> <a href="/play-tutorial/posts/scalafmt/" class="btn btn-outline-primary"><p>Scalafmt</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const observer = lozad(); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="copyright"><p class="mb-0"> © 2020<a href="https://www.linkedin.com/in/dvir-faivel-82b737b3/" class="ml-1">Dvir</a>. <br>Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a>, theme by <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a>.</p></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted">Trending Tags</h4><!-- The trending tags list v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT Licensed --> <a class="post-tag" href="/play-tutorial/tags/compile-time-dependency-injection/">compile time dependency injection</a> <a class="post-tag" href="/play-tutorial/tags/typesafe-config/">typesafe config</a> <a class="post-tag" href="/play-tutorial/tags/json/">json</a> <a class="post-tag" href="/play-tutorial/tags/db-api/">db api</a> <a class="post-tag" href="/play-tutorial/tags/tests/">tests</a> <a class="post-tag" href="/play-tutorial/tags/slf4j/">slf4j</a> <a class="post-tag" href="/play-tutorial/tags/skeleton/">skeleton</a> <a class="post-tag" href="/play-tutorial/tags/scalafmt/">scalafmt</a> <a class="post-tag" href="/play-tutorial/tags/sbt-native-packager/">sbt native packager</a> <a class="post-tag" href="/play-tutorial/tags/pureconfig/">pureconfig</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', '', 'auto'); ga('send', 'pageview'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js" integrity="sha256-qcLR00zq6pJk4je3MLgAri8Nn+ZumUlXgTKR2H/xCY0=" crossorigin="anonymous"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/play-tutorial/assets/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://dvirf.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
